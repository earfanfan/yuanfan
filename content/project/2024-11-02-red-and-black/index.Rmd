---
title: 看一看我国机关事业单位的养老标准
author: yuanfan
date: 2024-11-02T22:16:58+0800
slug: red and black
categories:
  - R
tags:
  - R
draft: no
output:
  blogdown::html_page:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,warning = FALSE,message = FALSE)
```

<!--more-->

根据[2023 年度人力资源和社会保障事业发展统计公报](https://www.mohrss.gov.cn/SYrlzyhshbzb/zwgk/szrs/tjgb/202406/W020240617617024381518.pdf)，截止2023年底，全国养老保险的总体数据如下表所示。

|类别|参保人数（万人）|缴费人数（万人）|离退休人数（万人）|基金收入（亿元）|基金支出（亿元）|
|:--------------:|:--:|:--:|:--:|:--:|:--:|
|城镇职工基本养老保险|52121|37925|14196|70506|63757|
|城乡居民基本养老保险|54522|37354|17268|6185|4613|

从这五个指标，可以进一步计算三个新的指标，分别是`人均每月缴费金额 = (基金收入/缴费人数)/12`、`人均每月领取金额 = (基金支出/离退休人数)/12`、`离退休人员占比 = 离退休人数/参保人数`。这里可以看出，参加城乡居民基本养老保险的缴费少、领取少，每1.6人缴费可以供养1名离退休人员；而参加城镇职工基本养老保险的缴费多、领取多，每2.4人缴费才可供养1名离退休人员。

|类别|人均每月缴费金额（元）|人均每月领取金额（元）|领取/缴费|离退休人员占比|
|:--------------:|:--:|:--:|:--:|:--:|
|城镇职工基本养老保险|1549|3742|2.4|27%|
|城乡居民基本养老保险|137|222|1.6|32%|

城乡居民和城镇职工的养老保险标准固然差异巨大，但键者更加好奇的是，机关事业单位的养老标准又如何？

```{r}
library(data.table)
library(echarts4r)
library(DT)
library(sparkline)

spark_html <- function(...) {
  as.character(htmltools::as.tags(sparkline(..., height = 50, width = 100)))}

xjdata <- fread('data/XJTJGB.csv')
```

# 一、数据说明

根据前作[使用 R base 抓取网页数据--基于红黑统计公报库](https://yuanfan.rbind.io/project/r-crawl-data2/)，键者收集整理了一些县级的统计公报。在一切开始之前，有必要对本文的数据来源做些说明，将来若有读者读到这里时，任何时候都可以对下文提及的数据尽情质疑。

其一，红黑统计公报库网页上展示的内容“应该是”来源于官方渠道，但是存在和官方不一致的情况，比如“成武县2023年国民经济和社会发展统计公报”，在[此网站中](https://tjgb.hongheiku.com/xjtjgb/xj2020/48602.html)有这样一段文字“社会保障能力稳步提高。2023年机关事业单位退休人员8778人，发放养老待遇7.85亿元；企业单位离退休人员13220人，发放养老待遇3.69亿元；城乡居民养老保险待遇领取人员11.94万人，发放养老待遇2.51亿元；”，而现在[官方网站中](http://www.chengwu.gov.cn/10086/8a1af4577d6741fa017d763b1e830012/1783057580797644800.html)已有删减，只剩下“城乡居民养老保险待遇领取人员11.94万人”。

其二，抓取下来的统计公报内容是文本形式，而键者是手动整理成了表格形式的数据，在这过程中可能存在失误。

接下来，对本文的数据口径也做些说明。

其一，键者写作此文的初衷是对比机关事业单位与其他阶层在养老待遇上的差异，因此在范围上仅筛选整理公布了机关事业单位的养老保险数据的统计公报。

其二，所整理的指标主要针对的是养老保险数据，按照机关事业单位、企业职工、城乡居民划分为三个类别，每个类别再分别整理五种指标，即参保人数、（在职）缴费人数、离退休人数、征缴保费收入、养老待遇支出，其中参保人数应为缴费人数与离退休人数之和。这些县级统计公报因撰文的作者不同，针对类似指标所写的名称和具体写法都有很多不同，遇到指标含义模糊的情况，键者会根据同一个县历年公报公开数据来理解并整理。有些实在无法辨认具体口径的数据，为了避免出错，只好放弃整理。

其三，仅有极少数县级公报会公布养老保险数据的历年全貌，绝大多数县或是仅公布参保和领取待遇的人数，或是仅公布养老保险基金的收入和支出，再或者某年只公布人数、某年又只公布金额。

# 二、机关事业单位的养老保险数据概况

## 2.1.发放养老待遇水平

筛选机关事业单位的养老保险支出、离退休人数均不为空的数据，共涉及21个省级行政区（省份、直辖市或自治区），60个地级行政区（地级市、自治州）的71个县级行政区。计算出每年的人均领取金额，由于养老金会连续上调，因而下表中仅展示每个县在2020年及以后最新年份的那条数据。

```{r}
data <-
  xjdata[!is.na(机关养老保险支出万元) &
           !is.na(机关养老保险离退休人数)][, ':='(`机关人均领取金额元` = round(`机关养老保险支出万元` * 10000 / `机关养老保险离退休人数`, 0))]

result <-
  data[`年份` >= 2020, .SD[which.max(`年份`)], by = .(`城市名`, `县区名`)]

datatable(result[, c('所属省份',
                     '城市名',
                     '县区名',
                     '年份',
                     '机关养老保险离退休人数',
                     '机关养老保险支出万元',
                     '机关人均领取金额元')],
          rownames = FALSE,
          options = list(
            order = list(list(1, 'asc'), list(3, 'desc')),
            language = list(
              lengthMenu = '展示 _MENU_ 每页记录数',
              search = '检索：',
              zeroRecords = '什么都没有找到',
              infoEmpty = '找不到记录',
              infoFiltered = '(从 _MAX_ 条数据中筛选)',
              info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
              paginate = list(previous = '上一页', `next` = '下一页')
            )
          ))
```

在这71个县的数据中，机关事业单位人均领取养老待遇的最小值是，河南省商丘市民权县在2022年的42383元，平均到每月就是3532元；最大值是云南省迪庆藏族自治州维西傈僳族自治县在2023年的119001元，平均到每月就是9917元；中位数是64048元，平均到每月是5337元。

我国机关事业单位的养老待遇由政府来进行发放，养老金标准是否上调以及上调多少亦由政府控制，具体来说每一级政府管理每一级机关事业单位的养老标准。若将这71个县的数据按省分开展示，如下图，省份之间不同县也会存在极大的差异。

```{r}
result[order(`所属省份`)] |> 
  group_by(`所属省份`) |> 
  e_charts() |> 
  e_boxplot(`机关人均领取金额元`)|>
  e_x_axis(
    axisLabel = list(interval = 0, rotate = 30)
  ) |>
  e_tooltip(trigger = 'axis')|>
  e_title(text='机关事业单位-人均领取养老待遇（元）',subtext='仅限公布该类数据的71个县')|>
  e_grid(right = 10)
```

## 2.2.离退休人数的占比

筛选机关事业单位的养老保险参保人数、离退休人数、缴费人数均不为空的数据，共涉及25个省级行政区（省份、直辖市或自治区），83个地级行政区（地级市、自治州）的108个县级行政区。计算出离退休人数占参保人数的比例，仅保留每个县在2020年及以后最新年份的那条数据。

```{r}
data <-
  xjdata[!is.na(机关养老保险离退休人数) &
           !is.na(机关养老保险缴费人数)&!is.na(机关养老保险参保人数)][, ':='(
             `占比（离退休人数/参保人数）`=round(机关养老保险离退休人数/机关养老保险参保人数,2)
           )]

result <- data[`年份` >= 2020, .SD[which.max(`年份`)], by = .(`城市名`, `县区名`)]

datatable(result[, c(
  '所属省份',
  '城市名',
  '县区名',
  '年份',
  '机关养老保险参保人数',
  '机关养老保险缴费人数',
  '机关养老保险离退休人数',
  '占比（离退休人数/参保人数）'
)],
rownames = FALSE,
options = list(
  order = list(list(1, 'asc'), list(3, 'desc')),
  language = list(
    lengthMenu = '展示 _MENU_ 每页记录数',
    search = '检索：',
    zeroRecords = '什么都没有找到',
    infoEmpty = '找不到记录',
    infoFiltered = '(从 _MAX_ 条数据中筛选)',
    info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
    paginate = list(previous = '上一页', `next` = '下一页')
  )
))|>formatPercentage(columns = 8,
                   digits = 0)
```

在这108个县的数据中，离退休人数占比最低的是新疆维吾尔自治区喀什地区莎车县的3%，参保人数是42254，离退休人数是1421；而占比最高的是河南省洛阳市西工区的84%，参保人数为3409人，而离退休人数为2854人。

根据本文开头2023年度的全国数据，城镇职工基本养老保险的离退休人员占比为27%。按照当前的制度，机关事业单位的养老保险数据是被计入城镇职工之中的。仅在这108个县的数据中，离退休人员占比的平均值是38.9%，中位数是37%。那么存在一种可能，那就是在所有城镇职工基本养老保险数据中，机关事业单位整体离退休人员占比更高，企业整体离退休人员占比更低，两者综合之后才得到了一个平均值27%。

继续观察这108个县离退休人员占比数据：取值在(0,20%]的有4个县，占比4%；取值在(20%,30%]的有23个县，占比21%；取值在(30%,40%]的有40个县,占比37%;取值在(40%,50%]的有12个县，占比11%;取值大于50%的有19个县，占比18%。如此分布可知，是108个县中多数县的离退休人员占比都高，而不只是少数极值拉高了平均值。若再分省去看，各省不同县的水平差异也大，但一大半都超过了27%。

```{r}
result[order(`所属省份`)] |> 
  group_by(`所属省份`) |> 
  e_charts() |> 
  e_boxplot(`占比（离退休人数/参保人数）`)|>e_x_axis(
    axisLabel = list(interval = 0, rotate = 30)
  ) |>
  e_tooltip(trigger = 'axis')|>
  e_title(text='机关事业单位-离退休人员占比',subtext='仅限公布该类数据的108个县')|>
  e_mark_line("占比（离退休人数/参保人数）", data = list(yAxis = 0.27)) |>
  e_grid(right = 10)
```

## 2.3.人均缴费与领取之差

筛选机关事业单位的养老保险支出、离退休人数、缴费金额、缴费人数均不为空的数据，共涉及19个省级行政区（省份、直辖市或自治区），41个地级行政区（地级市、自治州）的46个县级行政区。计算出每年的人均领取金额、人均缴费金额以及两者的倍数，仅保留每个县在2020年及以后最新年份的那条数据。

```{r}
data <-
  xjdata[!is.na(机关养老保险支出万元) &
           !is.na(机关养老保险离退休人数) &
           !is.na(机关养老保险缴费万元) &
           !is.na(机关养老保险缴费人数)][, ':='(
             `机关人均领取金额元` = round(`机关养老保险支出万元` * 10000 / `机关养老保险离退休人数`, 0),
             `机关人均缴费金额元` = round(`机关养老保险缴费万元` * 10000 / `机关养老保险缴费人数`, 0),
             `金额倍数（领取/缴费）` = round((`机关养老保险支出万元`  / `机关养老保险离退休人数`) / (`机关养老保险缴费万元`  / `机关养老保险缴费人数`), 2),
             `人数倍数（缴费/离退休）` = round(`机关养老保险缴费人数` / `机关养老保险离退休人数`, 2)
           )]

result <- data[`年份` >= 2020, .SD[which.max(`年份`)], by = .(`城市名`, `县区名`)]

datatable(result[, c('所属省份',
                     '城市名',
                     '县区名',
                     '年份',
                     '机关人均缴费金额元',
                     '机关人均领取金额元',
                     '金额倍数（领取/缴费）',
                     '人数倍数（缴费/离退休）')],
          rownames = FALSE,
          options = list(
            order = list(list(1, 'asc'), list(3, 'desc')),
            language = list(
              lengthMenu = '展示 _MENU_ 每页记录数',
              search = '检索：',
              zeroRecords = '什么都没有找到',
              infoEmpty = '找不到记录',
              infoFiltered = '(从 _MAX_ 条数据中筛选)',
              info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
              paginate = list(previous = '上一页', `next` = '下一页')
            )
          ))
```

在这46个县的数据中，用人均领取金额除以人均缴费金额可以得到一个金额倍数。其中，最大值是云南省大理白族自治州巍山彝族回族自治县在2022年的数据，人均领取金额为94738元，人均缴费金额为16509元，倍数达到5.74倍，相当于平均一个离退休人员需要由5.74个在职缴费人员供养。而最小值是湖南省常德市武陵区在2023年的数据，人均领取金额为61819元，人均缴费金额为76289元，倍数仅为0.81，是这46个县中领取低于缴费的孤例。

观察这个金额倍数：取值在(0,1]的仅有1个县；取值在(1,2]的有12个县，占比26%；取值在(2,3]的有19个县,占比41%，取值在3以上的有14个县，占比30%。这说明，这46个县中绝大多数都需要在职人员是离退休人员的数倍，才能覆盖养老金缺口。但机关事业单位有过多在职人员又会造成县政府的财政压力，以及人员冗余问题。若再用在职缴费人数除以离退休人数得到一个人数倍数，可以算出人数倍数大于等于金额倍数的仅有7个县，也就是说另外39个县在养老金的整体收入和支出上存在缺口。

## 2.4.养老金缺口

筛选机关事业单位的养老保险支出和缴费金额均不为空的数据，共涉及20个省级行政区（省份、直辖市或自治区），56个地级行政区（地级市、自治州）的69个县级行政区。计算出每年的当年差额，即总缴费金额减去总支出金额，仅保留每个县在2020年及以后最新年份的那条数据。

```{r}
data <-
  xjdata[!is.na(机关养老保险支出万元) &
           !is.na(机关养老保险缴费万元)][, ':='(`当年差额（缴费金额-领取金额）万元` = round(机关养老保险缴费万元-机关养老保险支出万元, 2))]

result <- data[`年份` >= 2020, .SD[which.max(`年份`)], by = .(`城市名`, `县区名`)]

datatable(result[, c('所属省份',
                     '城市名',
                     '县区名',
                     '年份',
                     '机关养老保险缴费万元',
                     '机关养老保险支出万元',
                     '当年差额（缴费金额-领取金额）万元')],
          rownames = FALSE,
          options = list(
            order = list(list(1, 'asc'), list(3, 'desc')),
            language = list(
              lengthMenu = '展示 _MENU_ 每页记录数',
              search = '检索：',
              zeroRecords = '什么都没有找到',
              infoEmpty = '找不到记录',
              infoFiltered = '(从 _MAX_ 条数据中筛选)',
              info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
              paginate = list(previous = '上一页', `next` = '下一页')
            )
          ))
```

在这69个县的数据中，有59个县都存在养老金缺口，仅10个县是缴费金额覆盖了支出。若将这69条数据绘制散点图，横轴为养老保险的缴费金额，纵轴为支出金额，加一条`y = x`的直线，那么线下的是缴费覆盖了支出的县，养老金的当年差额大于0，但显然这10个县的养老金当年差额也不算多。

```{r}
result |>
  e_charts(`机关养老保险缴费万元`) |> #横轴
  e_scatter(`机关养老保险支出万元`, symbol_size = 14) |> #纵轴
  e_x_axis(name = "机关养老保险缴费万元",
           nameLocation = "center",
           nameGap = 30) |>
  e_y_axis(name = "机关养老保险支出万元",
           nameLocation = "center",
           nameGap = 50) |>
  e_legend(show = FALSE) |>
  e_title(text = '机关事业单位-养老金缺口', subtext = '仅限公布该类数据的69个县') |>
  e_mark_line(data = list(list(xAxis = 0, # 增加一条 y=x 的直线
                               yAxis = 0),
                          list(xAxis = 100000,
                               yAxis = 100000))) |> e_grid(right = 10)
```

## 2.5.人数的变化趋势

筛选机关事业单位的养老保险缴费人数不为空的数据，留下至少有2条数据的县，共涉及19个省级行政区（省份、直辖市或自治区），51个地级行政区（地级市、自治州）的64个县级行政区。

```{r}
data <-
  xjdata[!is.na(机关养老保险缴费人数) & !is.na(机关养老保险离退休人数)]

result <- data[, .SD[.N > 1], by = `县区名`]

setorder(result, `县区名`, `年份`)

dt <- result[, .(
  `所属省份` = max(`所属省份`),
  `城市名` = max(`城市名`),
  '缴费人数变化趋势' = spark_html(
    `机关养老保险缴费人数`,
    type = "line",
    lineColor = "#008E90FF",
    fillColor = "#008E90FF"
  ),
  '离退休人数变化趋势' = spark_html(
    `机关养老保险离退休人数`,
    type = "line",
    lineColor = "#CEC917FF",
    fillColor = "#CEC917FF"
  )
), keyby = .(`县区名`)]

datatable(
  dt[, c('所属省份',
         '城市名',
         '县区名', '缴费人数变化趋势', '离退休人数变化趋势')],
  rownames = FALSE,
  escape = FALSE,
  options = list(
    pageLength = 5,
    # 每次分页重新渲染，不加这个的话只有第一页有图
    drawCallback = JS('function(s) { HTMLWidgets.staticRender(); }'),
    language = list(
      lengthMenu = '展示 _MENU_ 每页记录数',
      search = '检索：',
      zeroRecords = '什么都没有找到',
      infoEmpty = '找不到记录',
      infoFiltered = '(从 _MAX_ 条数据中筛选)',
      info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
      paginate = list(previous = '上一页', `next` = '下一页')
    )
  )
) |> spk_add_deps()
```

在这64个县的数据中，缴费人数呈现上升趋势的有30个，离退休人数呈现下降趋势的只有5个。一个县机关事业单位的养老保险情况可以有这几种：第一种是缴费人数上升、离退休人数下降，有四川省甘孜藏族自治州九龙县、安徽省淮北市杜集区、新疆维吾尔自治区喀什地区莎车县等3个县，数量极少；第二种是缴费人数下降、离退休人数下降，有山东省临沂市河东区、湖南省郴州市安仁县等2个县，数量也极少；第三种是缴费人数上升、离退休人数上升，有28个县，占比44%，这样的趋势或许可以缓解养老金缺口，但是财政供养人员的薪资和养老金均会增加，政府的财政负担会加重；第四种是缴费人数下降、离退休人数上升，有22个县，占比34%，这样的趋势下养老金缺口可能会继续扩大，同时在职缴费人数下降也意味着政府行政管理人力流失或者去除冗余；第五种是缴费人数或离退休人数几乎持平，有9个县，占比14%。

## 2.6.养老金缺口的变化趋势

筛选机关事业单位的养老保险支出和缴费金额均不为空的数据，留下至少有2条数据的县，共涉及17个省级行政区（省份、直辖市或自治区），40个地级行政区（地级市、自治州）的51个县级行政区。

```{r}
data <-
  xjdata[!is.na(机关养老保险缴费万元) &
           !is.na(机关养老保险支出万元)][, ':='(`当年差额` = round(`机关养老保险缴费万元` - `机关养老保险支出万元`, 0))]

result <- data[, .SD[.N > 1], by = `县区名`]

setorder(result, `县区名`, `年份`)

dt <- result[, .(
  `所属省份` = max(`所属省份`),
  `城市名` = max(`城市名`),
  `差额（缴费-领取）变化趋势` = spark_html(`当年差额`,
                               type = "bar", barWidth = 30)
), keyby = .(`县区名`)]

datatable(
  dt[, c('所属省份',
         '城市名',
         '县区名', '差额（缴费-领取）变化趋势')],
  rownames = FALSE,
  escape = FALSE,
  options = list(
    pageLength = 5,
    # 每次分页重新渲染，不加这个的话只有第一页有图
    drawCallback = JS('function(s) { HTMLWidgets.staticRender(); }'),
    language = list(
      lengthMenu = '展示 _MENU_ 每页记录数',
      search = '检索：',
      zeroRecords = '什么都没有找到',
      infoEmpty = '找不到记录',
      infoFiltered = '(从 _MAX_ 条数据中筛选)',
      info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
      paginate = list(previous = '上一页', `next` = '下一页')
    )
  )
) |> spk_add_deps()
```

# 三、机关与企业、城乡居民的对比

## 3.1.养老待遇的差异

### 3.1.1.机关 VS 企业

筛选机关事业单位和企业的养老保险支出、离退休人数均不为空的数据，共涉及17个省级行政区（省份、直辖市或自治区），42个地级行政区（地级市、自治州）的66个县级行政区。分别计算出机关事业单位和企业每年的人均领取金额，再进一步用机关事业单位的人均领取金额除以企业的人均领取金额得到一个金额倍数，取每个县在2020年及以后最新年份的那条数据。

```{r}
data <-
  xjdata[!is.na(机关养老保险支出万元) &
           !is.na(机关养老保险离退休人数) &
           !is.na(企业养老保险离退休万人) &
           !is.na(企业养老保险支出万元)][, ':='(
             `机关人均领取金额元` = round(`机关养老保险支出万元` * 10000 / `机关养老保险离退休人数`, 0),
             `企业人均领取金额元` = round(`企业养老保险支出万元` / `企业养老保险离退休万人`, 0),
             `企业养老保险离退休人数` = 企业养老保险离退休万人 * 10000,
             `金额倍数（机关人均领取/企业人均领取）` = round((`机关养老保险支出万元` * 10000 / `机关养老保险离退休人数`) / (`企业养老保险支出万元` / `企业养老保险离退休万人`),2 ))]

result <-
  data[`年份` >= 2020, .SD[which.max(`年份`)], by = .(`城市名`, `县区名`)]

datatable(result[, c('所属省份',
                     '城市名',
                     '县区名',
                     '年份',
                     '机关养老保险离退休人数',
                     '机关人均领取金额元',
                     '企业养老保险离退休人数',
                     '企业人均领取金额元','金额倍数（机关人均领取/企业人均领取）')],
          rownames = FALSE,
          options = list(
            order = list(list(1, 'asc'), list(3, 'desc')),
            language = list(
              lengthMenu = '展示 _MENU_ 每页记录数',
              search = '检索：',
              zeroRecords = '什么都没有找到',
              infoEmpty = '找不到记录',
              infoFiltered = '(从 _MAX_ 条数据中筛选)',
              info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
              paginate = list(previous = '上一页', `next` = '下一页')
            )
          )) |> formatRound(columns = c(5:8), digits = 0)
```

在这66个县的数据中，观察金额倍数（机关人均领取/企业人均领取）：取值在(0,1]的仅有1个县；取值在(1,2]的有27个县，占比41%；取值在(2,3]的有32个县，占比48%；取值大于3的有6个县，占比9%。

### 3.1.2.机关 VS 城乡居民

筛选机关事业单位和城乡居民的养老保险支出、离退休人数均不为空的数据，共涉及17个省级行政区（省份、直辖市或自治区），42个地级行政区（地级市、自治州）的49个县级行政区。分别计算出机关事业单位和城乡居民业每年的人均领取金额，再进一步用机关事业单位的人均领取金额除以城乡居民的人均领取金额得到一个金额倍数，取每个县在2020年及以后最新年份的那条数据。

```{r}
data <-
  xjdata[!is.na(机关养老保险支出万元) &
           !is.na(机关养老保险离退休人数) &
           !is.na(城乡养老保险离退休万人) &
           !is.na(城乡养老保险支出万元)][, ':='(
             `机关人均领取金额元` = round(`机关养老保险支出万元` * 10000 / `机关养老保险离退休人数`, 0),
             `城乡人均领取金额元` = round(`城乡养老保险支出万元` / `城乡养老保险离退休万人`, 0),
             `金额倍数（机关人均领取/城乡居民人均领取）` = round((`机关养老保险支出万元` * 10000 / `机关养老保险离退休人数`) / (`城乡养老保险支出万元` / `城乡养老保险离退休万人`),2 ),
             `城乡养老保险离退休人数`=`城乡养老保险离退休万人`*10000
           )]

result <-
  data[`年份` >= 2020, .SD[which.max(`年份`)], by = .(`城市名`, `县区名`)]

datatable(result[, c('所属省份',
                     '城市名',
                     '县区名',
                     '年份',
                     '机关养老保险离退休人数',
                     '机关人均领取金额元',
                     '城乡养老保险离退休人数',
                     '城乡人均领取金额元',
                     '金额倍数（机关人均领取/城乡居民人均领取）')],
          rownames = FALSE,
          options = list(
            order = list(list(1, 'asc'), list(3, 'desc')),
            language = list(
              lengthMenu = '展示 _MENU_ 每页记录数',
              search = '检索：',
              zeroRecords = '什么都没有找到',
              infoEmpty = '找不到记录',
              infoFiltered = '(从 _MAX_ 条数据中筛选)',
              info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
              paginate = list(previous = '上一页', `next` = '下一页')
            )
          ))|> formatRound(columns = c(5:8), digits = 0)
```

在这49个县的数据中，观察金额倍数（机关人均领取/城乡居民人均领取）：取值在(10,20]的仅有1个县；取值在(20,30]的有11个县，占比22%；取值在(30,40]的有25个县，占比51%；取值大于40的有9个县，占比18%。

## 3.2.离退休人员占比的差异

### 3.2.1.机关 VS 企业

筛选机关事业单位和企业的养老保险参保人数、离退休人数均不为空的数据，共涉及23个省级行政区（省份、直辖市或自治区），75个地级行政区（地级市、自治州）的95个县级行政区。分别计算出机关事业单位和企业的离退休人员占比，取每个县在2020年及以后最新年份的那条数据。

```{r}
data <-
  xjdata[!is.na(机关养老保险参保人数) &
           !is.na(机关养老保险离退休人数) &
           !is.na(企业养老保险离退休万人) &
           !is.na(企业养老保险参保万人)][, ':='(
             `机关离退休人员占比` = round(机关养老保险离退休人数 / 机关养老保险参保人数, 2),
             `企业离退休人员占比` = round(企业养老保险离退休万人 / 企业养老保险参保万人, 2),
             `企业养老保险参保人数`=`企业养老保险参保万人`*10000
           )]

result <-
  data[`年份` >= 2020, .SD[which.max(`年份`)], by = .(`城市名`, `县区名`)]

datatable(result[, c('所属省份',
                     '城市名',
                     '县区名',
                     '年份',
                     '机关养老保险参保人数',
                     '机关离退休人员占比',
                     '企业养老保险参保人数',
                     '企业离退休人员占比')],
          rownames = FALSE,
          options = list(
            order = list(list(1, 'asc'), list(3, 'desc')),
            language = list(
              lengthMenu = '展示 _MENU_ 每页记录数',
              search = '检索：',
              zeroRecords = '什么都没有找到',
              infoEmpty = '找不到记录',
              infoFiltered = '(从 _MAX_ 条数据中筛选)',
              info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
              paginate = list(previous = '上一页', `next` = '下一页')
            )
          )) |>
  formatPercentage(columns = c(6, 8), digits = 0) |>
  formatRound(columns = c(5, 7), digits = 0)
```

在这95个县的数据中，机关离退休人员占比高于企业的有60个县。若仅将95个县的数据汇总，企业养老保险参保人数一共499万，其中离退休人数一共152万，离退休人员占比为30%；机关事业单位的养老保险参保人数一共111万，其中离退休人数一共42万，离退休人员占比为38%。

### 3.2.2.机关 VS 城乡居民

筛选机关事业单位和城乡居民的养老保险参保人数、离退休人数均不为空的数据，共涉及18个省级行政区（省份、直辖市或自治区），53个地级行政区（地级市、自治州）的65个县级行政区。分别计算出机关事业单位和城乡居民的离退休人员占比，取每个县在2020年及以后最新年份的那条数据。

```{r}
data <-
  xjdata[!is.na(机关养老保险参保人数) &
           !is.na(机关养老保险离退休人数) &
           !is.na(城乡养老保险离退休万人) &
           !is.na(城乡养老保险参保万人)][, ':='(
             `机关离退休人员占比` = round(机关养老保险离退休人数 / 机关养老保险参保人数, 2),
             `城乡居民离退休人员占比` = round(城乡养老保险离退休万人 / 城乡养老保险参保万人, 2),
             `城乡居民养老保险参保人数`=`城乡养老保险参保万人`*10000
           )]

result <-
  data[`年份` >= 2020, .SD[which.max(`年份`)], by = .(`城市名`, `县区名`)]

datatable(result[, c('所属省份',
                     '城市名',
                     '县区名',
                     '年份',
                     '机关养老保险参保人数',
                     '机关离退休人员占比',
                     '城乡居民养老保险参保人数',
                     '城乡居民离退休人员占比')],
          rownames = FALSE,
          options = list(
            order = list(list(1, 'asc'), list(3, 'desc')),
            language = list(
              lengthMenu = '展示 _MENU_ 每页记录数',
              search = '检索：',
              zeroRecords = '什么都没有找到',
              infoEmpty = '找不到记录',
              infoFiltered = '(从 _MAX_ 条数据中筛选)',
              info = '共 _TOTAL_ 条记录，从 _START_ 到 _END_',
              paginate = list(previous = '上一页', `next` = '下一页')
            )
          )) |>
  formatPercentage(columns = c(6, 8), digits = 0) |>
  formatRound(columns = c(5, 7), digits = 0)
```

在这65个县的数据中，机关离退休人员占比高于城乡居民的有50个县。若仅将65个县的数据汇总，城乡居民养老保险参保人数一共1115万，其中离退休人数一共383万，离退休人员占比为34%；机关事业单位的养老保险参保人数一共74万，其中离退休人数一共28万，离退休人员占比为38%。

💪🌟
